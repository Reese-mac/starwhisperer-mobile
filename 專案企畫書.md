# Minimal Moon Weather 專案企畫書

## 專案定位
- **目的**：打造一款以「靜謐夜間儀式」為核心的月亮天氣 App，陪伴使用者校準當下情緒。
- **主張**：極簡 UI，所有互動維持慢速、柔和；提供月相資訊、冥想語句與 fallback 體驗。

## 系統架構概述
- **入口**：`app/_layout.tsx` 切換 `ritual` 習俗畫面 → `/(tabs)` 主視圖。
- **主要畫面**：Home、Moon、Modal、Settings、Explore 等路由使用 Expo Router 管理。
- **資料來源**：`api/WeatherService.ts` 走 OpenWeather API；`src/services/mockAPI.ts` 提供離線 / fallback。

## 作業流程紀錄（2025/12 最新）

### 1. Ritual Flow
- 移除舊 onboarding，保留 ritual 作為唯一啟動畫面。
- Ritual 由 LinearGradient + 文字 Logo 組成，Reanimated 進行淡入與緩呼吸，2.6 秒後自動切到 Tab。
- `AsyncStorage` 儲存 `ritual_done` 避免重複播放；Home 的 replay 按鈕已徹底移除。

### 2. Home Page 穩定化
- `useWeatherData` hook 控管 live vs mock 狀態；`SAMPLE_DATA_NOTICE` 用 Info banner 告知使用者。
- HeaderCard 顯示城市 / whisper / moon button，Moon CTA 直接連到 `/moon`（moonEnergyPopup 供長按啟動）。
- 所有 InfoCard 建立 `expandedData` 使卡片可展開顯示 tempTrend、advice 或 waterTemp。

### 3. Moon + Modal Fallback 策略
- MoonScreen：若 live API 失敗，轉用 mock phases + “Showing sample moon cycles…” banner，所有卡片仍顯示 Rise/Set/Illumination。
- Modal：同樣先嘗試 `fetchMoonDetails`，失敗時改用 `getMockMoonDetails`，文字 banner 告知使用者正在顯示 sample data。

### 4. 依賴與環境
- Expo SDK 54 搭配 React Native 0.81.5：重新安裝 `react-native-svg@15.12.1` 避免 RNSVGEllipse 錯誤，保留 `expo-linear-gradient` 用於 Ritual 背景。
- 維護 package-lock 與 package.json 一致，`npm install` + `npx expo start` 即可跑；`npx expo start --clear` 用於重大 UI 更新後清 cache。

### 5. 測試與驗證
- Pixel 6 API 36 模擬器為主要驗證環境：檢查 Ritual → Tabs → Moon → Modal 全流程。
- 手動觸發 API 失敗（拔網或改 key）驗證 fallback UI。
- 使用 `npm ls`、`expo doctor`，確保依賴正確；Metro reload 出現 Expo icon 表示 Bundler 正在重建，等待完成即可。

## 交付狀態
- UI/flow 已符合「字體 Logo + 紫色漸層 + sample fallback」規格，畫面穩定無紅錯。
- 專案含兩份企畫文件（本檔及《專案氛圍企畫書》）；`MinimalMoon_Documentation.pdf` 匯出可對外分享。
- 專案目前處於可 demo / 可交接狀態：啟動、資料展示、錯誤處理、fallback 全部可用。

